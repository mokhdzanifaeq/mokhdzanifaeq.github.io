<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="on my previous post, i have covered on how to extract instagram’s signature key by hooking a function. but since the methods are a bit complex (setting up NDK etc.), i will show you another way of ext">
<meta name="keywords" content="android,instagram,hook,gikdbg,key">
<meta property="og:type" content="article">
<meta property="og:title" content="Extracting instagram signature key II">
<meta property="og:url" content="http://mokhdzanifaeq.github.io/2015/09/28/extracting-instagram-signature-key-2/index.html">
<meta property="og:site_name" content="mkhdznfq">
<meta property="og:description" content="on my previous post, i have covered on how to extract instagram’s signature key by hooking a function. but since the methods are a bit complex (setting up NDK etc.), i will show you another way of ext">
<meta property="og:image" content="http://i.imgur.com/4eSUL97.png">
<meta property="og:image" content="http://i.imgur.com/N0zUnvI.gif">
<meta property="og:image" content="http://i.imgur.com/oatSqm7.gif">
<meta property="og:image" content="http://i.imgur.com/zaq9Wch.gif">
<meta property="og:image" content="http://i.imgur.com/XcZ4pEB.png">
<meta property="og:image" content="http://i.imgur.com/Hj1oE5V.gif">
<meta property="og:updated_time" content="2017-04-09T07:25:42.165Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Extracting instagram signature key II">
<meta name="twitter:description" content="on my previous post, i have covered on how to extract instagram’s signature key by hooking a function. but since the methods are a bit complex (setting up NDK etc.), i will show you another way of ext">
<meta name="twitter:image" content="http://i.imgur.com/4eSUL97.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Extracting instagram signature key II</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2016/05/24/wargames-my-2016-writeups/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/2015/07/27/extracting-instagram-signature-key/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
    </span>
    <br/>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#GikDbg"><span class="toc-number">1.</span> <span class="toc-text">GikDbg</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Methodologies"><span class="toc-number">2.</span> <span class="toc-text">Methodologies</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
          <header id="header">
  <a href="/">
  
    
      <div id="logo" style="background-image: url(/images/logo.png);"></div>
    
  
    <div id="title">
      <h1>mkhdznfq</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#"><i class="fa fa-bars fa-2x"></i></a>
      </li>
       
        <li><a href="/">Home</a></li>
       
        <li><a href="/archives/">Archives</a></li>
       
        <li><a href="http://github.com/mokhdzanifaeq">Projects</a></li>
      
    </ul>
  </div>
</header>

        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Extracting instagram signature key II
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">mkhdznfq</span>
      </span>
      
    <div class="postdate">
        <time datetime="2015-09-28T05:55:29.000Z" itemprop="datePublished">2015-09-28</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>, <a class="tag-link" href="/tags/gikdbg/">gikdbg</a>, <a class="tag-link" href="/tags/hook/">hook</a>, <a class="tag-link" href="/tags/instagram/">instagram</a>, <a class="tag-link" href="/tags/key/">key</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>on my previous post, i have covered on how to extract instagram’s signature key by hooking a function. but since the methods are a bit complex (setting up NDK etc.), i will show you another way of extracting the signature by using GikDbg (a.k.a. OllyDbg for mobile)</p>
<h2 id="GikDbg"><a href="#GikDbg" class="headerlink" title="GikDbg"></a>GikDbg</h2><p>gikdbg is a mobile assembly-level debugger for windows platform. the debugger is based on 3 main software:</p>
<ul>
<li><a href="http://www.ollydbg.de/" target="_blank" rel="external">OllyDbg</a> (32-bit assembler level analysing debugger)</li>
<li><a href="https://www.gnu.org/software/gdb/" target="_blank" rel="external">GDB</a> (GNU project debugger)</li>
<li><a href="http://llvm.org/" target="_blank" rel="external">LLVM</a> (collection of modular and reusable compiler and toolchain technologies)</li>
</ul>
<h2 id="Methodologies"><a href="#Methodologies" class="headerlink" title="Methodologies"></a>Methodologies</h2><p>in order to begin working with gikdbg, we will need an android system running on ART runtime (android debugging enabled). then, connect your device to your computer and open gikdbg. starting gikdbg, we will be greeted with the following screen</p>
<p><img src="http://i.imgur.com/4eSUL97.png" alt="start"></p>
<p>Next step is to connect the debugger to our android system. this can be performed from the menu <strong>ART Debug</strong> &gt; <strong>Server</strong> &gt; <strong>Device</strong>. then choose your android system from the list. Double click on it and a dialog will appear, asking wherever to install the appropriate libs to your android sytem. click “Yes”</p>
<p><img src="http://i.imgur.com/N0zUnvI.gif" alt="connect"></p>
<p>if everything went well, ADB Shell window will appear. now run the instagram app in your android system and attach the process to the debugger through the menu <strong>ART Debug</strong> &gt; <strong>File</strong> &gt; <strong>Attach</strong>. next, select <strong>com.instagram.android</strong> from the process list and click on the “Attach” button and wait for it to load</p>
<p><img src="http://i.imgur.com/oatSqm7.gif" alt="attach"></p>
<p>now we need to view the memory of the binary file where the signature key get called. this can be accomplished from the menu <strong>ART Debug</strong> &gt; <strong>View</strong> &gt; <strong>Module</strong>. search for <strong>libstrings.so</strong> in the list and double click on the module</p>
<p><img src="http://i.imgur.com/zaq9Wch.gif" alt="module"></p>
<p>scroll down and find the strlen function which is called before <strong>crypto_auth_hmacsha256_init</strong> function and set a breakpoint with F2. then run the app with F9</p>
<p><img src="http://i.imgur.com/XcZ4pEB.png" alt="breakpoint"></p>
<p>now when you login to instagram in your android device, the breakpoint will be hit. the only thing to do now is extracting the key from the memory. we can accomplished that by right clicking on the register memory address that hold the key (in this case it would be r0) and choose “Follow in dump” from the menu</p>
<p><img src="http://i.imgur.com/Hj1oE5V.gif" alt="dump"></p>
<p>with the signature key extracted. now we can inspect all the signed request from the instagram app by using a http proxy debugger (fiddler, burp, etc.). have fun!</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#GikDbg"><span class="toc-number">1.</span> <span class="toc-text">GikDbg</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Methodologies"><span class="toc-number">2.</span> <span class="toc-text">Methodologies</span></a></li></ol>
    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 mokhdzanifaeq
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="http://github.com/mokhdzanifaeq">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'mokhdzanifaeq';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


