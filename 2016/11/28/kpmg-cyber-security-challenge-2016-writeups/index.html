<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="bounty_hunteri end up wasting hours of my time solving this challenge, just because we were trolled by the organizer. the system somehow did not accept the correct flag and one of the crew did actuall">
<meta name="keywords" content="ctf,writeup,stega,kpmg,pcap">
<meta property="og:type" content="article">
<meta property="og:title" content="KPMG Cyber Security Challenge 2016 writeups">
<meta property="og:url" content="http://mokhdzanifaeq.github.io/2016/11/28/kpmg-cyber-security-challenge-2016-writeups/index.html">
<meta property="og:site_name" content="mkhdznfq">
<meta property="og:description" content="bounty_hunteri end up wasting hours of my time solving this challenge, just because we were trolled by the organizer. the system somehow did not accept the correct flag and one of the crew did actuall">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://i.imgur.com/AkrMH1k.png">
<meta property="og:image" content="https://i.imgur.com/7VSArvE.png">
<meta property="og:image" content="https://i.imgur.com/5rW99V1.png">
<meta property="og:image" content="https://i.imgur.com/SH7P5EB.png">
<meta property="og:image" content="https://i.imgur.com/IymyKDY.jpg">
<meta property="og:image" content="https://i.imgur.com/LMmJ2gS.jpg">
<meta property="og:image" content="https://i.imgur.com/5mM7FEO.png">
<meta property="og:image" content="https://i.imgur.com/6h1vINP.jpg">
<meta property="og:image" content="https://i.imgur.com/TfBe4TZ.png">
<meta property="og:image" content="https://i.imgur.com/7soYw2q.png">
<meta property="og:image" content="https://i.imgur.com/OmJe8ik.jpg">
<meta property="og:updated_time" content="2017-10-18T10:19:20.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="KPMG Cyber Security Challenge 2016 writeups">
<meta name="twitter:description" content="bounty_hunteri end up wasting hours of my time solving this challenge, just because we were trolled by the organizer. the system somehow did not accept the correct flag and one of the crew did actuall">
<meta name="twitter:image" content="https://i.imgur.com/AkrMH1k.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>KPMG Cyber Security Challenge 2016 writeups</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2016/12/14/cybersocks-regional-2016-color-writeup/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/2016/05/24/wargames-my-2016-writeups/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
    </span>
    <br/>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#bounty-hunter"><span class="toc-number">1.</span> <span class="toc-text">bounty_hunter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chal-mel"><span class="toc-number">2.</span> <span class="toc-text">chal_mel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cipher-text"><span class="toc-number">3.</span> <span class="toc-text">cipher_text</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#serious-traffic"><span class="toc-number">4.</span> <span class="toc-text">serious_traffic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hard-crypto"><span class="toc-number">5.</span> <span class="toc-text">hard_crypto</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
          <header id="header">
  <a href="/">
  
    
      <div id="logo" style="background-image: url(/images/logo.png);"></div>
    
  
    <div id="title">
      <h1>mkhdznfq</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#"><i class="fa fa-bars fa-2x"></i></a>
      </li>
       
        <li><a href="/">Home</a></li>
       
        <li><a href="/archives/">Archives</a></li>
       
        <li><a href="http://github.com/mokhdzanifaeq">Projects</a></li>
      
    </ul>
  </div>
</header>

        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        KPMG Cyber Security Challenge 2016 writeups
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">mkhdznfq</span>
      </span>
      
    <div class="postdate">
        <time datetime="2016-11-28T08:07:30.000Z" itemprop="datePublished">2016-11-28</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/ctf/">ctf</a>, <a class="tag-link" href="/tags/kpmg/">kpmg</a>, <a class="tag-link" href="/tags/pcap/">pcap</a>, <a class="tag-link" href="/tags/stega/">stega</a>, <a class="tag-link" href="/tags/writeup/">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="bounty-hunter"><a href="#bounty-hunter" class="headerlink" title="bounty_hunter"></a>bounty_hunter</h2><p>i end up wasting hours of my time solving this challenge, just because we were trolled by the organizer. the system somehow did not accept the correct flag and one of the crew did actually said that the flag was wrong.</p>
<p>anyway the protocols statistic shows that the packet consist of some mail packets:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/chal_mel ⌚ 15:30:45</span><br><span class="line">$ tshark -r bounty_hunter_9b9a64928393b52380bcef3a5f5b3206.pcap -z io,phs</span><br><span class="line">  1   0.000000 192.168.9.153 -&gt; 192.168.9.130 TCP 66 49332 → 110 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1</span><br><span class="line">  2   0.016303 192.168.9.130 -&gt; 192.168.9.153 TCP 66 110 → 49332 [SYN, ACK] Seq=0 Ack=1 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1</span><br><span class="line">  3   0.016442 192.168.9.153 -&gt; 192.168.9.130 TCP 54 49332 → 110 [ACK] Seq=1 Ack=1 Win=65536 Len=0</span><br><span class="line">  4   0.018267 192.168.9.130 -&gt; 192.168.9.153 POP 64 S: +OK POP3</span><br><span class="line">  5   0.018469 192.168.9.153 -&gt; 192.168.9.130 POP 61 C: AUTH </span><br><span class="line">...</span><br><span class="line">===================================================================</span><br><span class="line">Protocol Hierarchy Statistics</span><br><span class="line">Filter: </span><br><span class="line"> </span><br><span class="line">eth                                      frames:1159 bytes:633144</span><br><span class="line">  ip                                     frames:1159 bytes:633144</span><br><span class="line">    tcp                                  frames:778 bytes:364644</span><br><span class="line">      pop                                frames:165 bytes:89890</span><br><span class="line">        imf                              frames:4 bytes:262</span><br><span class="line">      smtp                               frames:272 bytes:230625</span><br><span class="line">        imf                              frames:6 bytes:354</span><br><span class="line">      ftp                                frames:36 bytes:2825</span><br><span class="line">      ftp-data                           frames:3 bytes:2876</span><br><span class="line">      http                               frames:6 bytes:2408</span><br><span class="line">        data-text-lines                  frames:3 bytes:1140</span><br><span class="line">      data                               frames:1 bytes:55</span><br><span class="line">      ssl                                frames:25 bytes:12417</span><br><span class="line">        tcp.segments                     frames:3 bytes:4393</span><br><span class="line">          ssl                            frames:3 bytes:4393</span><br><span class="line">    udp                                  frames:365 bytes:266764</span><br><span class="line">      nbns                               frames:24 bytes:2208</span><br><span class="line">      http                               frames:1 bytes:175</span><br><span class="line">      dns                                frames:18 bytes:1670</span><br><span class="line">      llmnr                              frames:8 bytes:568</span><br><span class="line">      quic                               frames:314 bytes:262143</span><br><span class="line">    icmp                                 frames:16 bytes:1736</span><br><span class="line">===================================================================</span><br></pre></td></tr></table></figure>
<p>i decided to go through the emails to get an idea of whats going on</p>
<p><img src="https://i.imgur.com/AkrMH1k.png" alt="mail"></p>
<p>we can see that looping is asking for dancing’s public key. he then attach an pgp encrypted jpg file(Marauder’s Map.JPG.gpg) in the subsequent mail. you can extract the encrypted file using NetworkMiner or do just like I did, manually</p>
<p><img src="https://i.imgur.com/7VSArvE.png" alt="encrypted"></p>
<p>logically, looping had the file encrypted with dancing’s public key. therefore, we need to get dancing’s secret key in order to decrypt it. searching for frames which contains “.gpg”, i stumbled upon an FTP STOR request frame which seems to be uploading dancing-backup-key.gpg to an ftp server</p>
<p><img src="https://i.imgur.com/5rW99V1.png" alt="stor"></p>
<p>we can extract the key from the pcap by following the tcp stream of the FTP-DATA protocol just a few frame after the STOR request and save it as a raw file</p>
<p><img src="https://i.imgur.com/SH7P5EB.png" alt="secret key"></p>
<p>after importing dancing’s secret key to the keyring, we can try to decrypt the encrypted file. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/bounty_hunter ⌚ 21:33:35</span><br><span class="line">$ gpg --import dancing-backup-key.gpg </span><br><span class="line">gpg: key E7661C2F: secret key imported</span><br><span class="line">gpg: key E7661C2F: &quot;dancing &lt;dancing@cyberchallenge.com&gt;&quot; not changed</span><br><span class="line">gpg: Total number processed: 1</span><br><span class="line">gpg:              unchanged: 1</span><br><span class="line">gpg:       secret keys read: 1</span><br><span class="line">gpg:   secret keys imported: 1</span><br><span class="line"> </span><br><span class="line">~/Desktop/kpmg/bounty_hunter ⌚ 21:33:41</span><br><span class="line">$ gpg map.jpg.gpg </span><br><span class="line"> </span><br><span class="line">You need a passphrase to unlock the secret key for</span><br><span class="line">user: &quot;dancing &lt;dancing@cyberchallenge.com&gt;&quot;</span><br><span class="line">2048-bit RSA key, ID D11E5146, created 2016-11-08 (main key ID E7661C2F)</span><br><span class="line"> </span><br><span class="line">Enter passphrase: </span><br><span class="line">gpg: Interrupt caught ... exiting</span><br></pre></td></tr></table></figure>
<p>unfortunately, the file is password protected. running strings on the pcap did unearth some passwords, but none of them worked</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/bounty_hunter ⌚ 21:35:26</span><br><span class="line">$ strings bounty_hunter_9b9a64928393b52380bcef3a5f5b3206.pcap| grep pass</span><br><span class="line">+OK Send your password</span><br><span class="line">PASS hardpassword</span><br><span class="line">331 Please specify the password.</span><br><span class="line">PASS harderpassword</span><br></pre></td></tr></table></figure>
<p>i ran through the pcap again in wireshark and remembered that SMTP AUTH request are made in base64. copying the pass from the SMTP packet and base64 decoded it did the trick. the encrypted file was decrypted successfully</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/bounty_hunter ⌚ 21:38:29</span><br><span class="line">$ echo &quot;ZWFzeXBhc3N3b3Jk&quot; | base64 -d</span><br><span class="line">easypassword        </span><br><span class="line">                                                                                                              </span><br><span class="line">~/Desktop/kpmg/bounty_hunter ⌚ 21:41:45</span><br><span class="line">$ gpg map.jpg.gpg </span><br><span class="line"> </span><br><span class="line">You need a passphrase to unlock the secret key for</span><br><span class="line">user: &quot;dancing &lt;dancing@cyberchallenge.com&gt;&quot;</span><br><span class="line">2048-bit RSA key, ID D11E5146, created 2016-11-08 (main key ID E7661C2F)</span><br><span class="line"> </span><br><span class="line">gpg: encrypted with 2048-bit RSA key, ID D11E5146, created 2016-11-08</span><br><span class="line">      &quot;dancing &lt;dancing@cyberchallenge.com&gt;&quot;</span><br></pre></td></tr></table></figure>
<p>unfortunately nothing interesting was in the picture</p>
<p><img src="https://i.imgur.com/IymyKDY.jpg" alt="empty map"></p>
<p>going through the pcap again i was able to find another Marauder’s Map.JPG.gpg with different bytes on frame 592. decrypting it reveals us the flag</p>
<p><img src="https://i.imgur.com/LMmJ2gS.jpg" alt="flag"></p>
<h2 id="chal-mel"><a href="#chal-mel" class="headerlink" title="chal_mel"></a>chal_mel</h2><p>this was supposed to be an easy one, too bad i had my attention on another challenge. we were given with a pcap file full of http packets </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/chal_mel ⌚ 15:56:45</span><br><span class="line">$ tshark -r chal_mel.pcap -z io,phs</span><br><span class="line">  1   0.000000 192.168.0.126 -&gt; 192.168.0.50 TCP 78 64697 → 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=32 TSval=225483831 TSecr=0 SACK_PERM=1</span><br><span class="line">  2   0.000038 192.168.0.50 -&gt; 192.168.0.126 TCP 74 80 → 64697 [SYN, ACK] Seq=0 Ack=1 Win=28960 Len=0 MSS=1460 SACK_PERM=1 TSval=23023905 TSecr=225483831 WS=128</span><br><span class="line">  3   0.002017 192.168.0.126 -&gt; 192.168.0.50 TCP 66 64697 → 80 [ACK] Seq=1 Ack=1 Win=131744 Len=0 TSval=225483833 TSecr=23023905</span><br><span class="line">  4   0.002029 192.168.0.126 -&gt; 192.168.0.50 HTTP 261 GET /?/9j/4AAQSkZJRgABAQAASABIAAD/4QBYRXhpZgAATU0AKgAAAAgAAgESAAMAAAAB HTTP/1.1 </span><br><span class="line">...</span><br><span class="line">===================================================================</span><br><span class="line">Protocol Hierarchy Statistics</span><br><span class="line">Filter: </span><br><span class="line"> </span><br><span class="line">eth                                      frames:188116 bytes:142555699</span><br><span class="line">  ip                                     frames:188116 bytes:142555699</span><br><span class="line">    tcp                                  frames:188116 bytes:142555699</span><br><span class="line">      http                               frames:21681 bytes:64188708</span><br><span class="line">        data-text-lines                  frames:10841 bytes:61359194</span><br><span class="line">        urlencoded-form                  frames:1 bytes:393</span><br><span class="line">        image-gif                        frames:1 bytes:439</span><br><span class="line">===================================================================</span><br></pre></td></tr></table></figure>
<p>the first GET request path literally screams base64, and decoding it shows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/chal_mel ⌚ 15:57:12</span><br><span class="line">$ tshark -r chal_mel.pcap -Y &quot;frame.number == 4&quot; | awk &apos;&#123;print substr($9, 3)&#125;&apos; | base64 -d | xxd</span><br><span class="line">00000000: ffd8 ffe0 0010 4a46 4946 0001 0100 0048  ......JFIF.....H</span><br><span class="line">00000010: 0048 0000 ffe1 0058 4578 6966 0000 4d4d  .H.....XExif..MM</span><br><span class="line">00000020: 002a 0000 0008 0002 0112 0003 0000 0001  .*..............</span><br></pre></td></tr></table></figure>
<p>that is obviously a jpg header. let’s try to decode all the GET request and redirect the stream to a jpg file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/chal_mel ⌚ 15:57:59</span><br><span class="line">$ tshark -r chal_mel.pcap -Y &quot;http.request.method == GET&quot; | awk &apos;&#123;print substr($9, 3)&#125;&apos; | base64 -d &gt; flag.jpg</span><br></pre></td></tr></table></figure>
<p>zooming in the decoded picture reveals us the flag</p>
<p><img src="https://i.imgur.com/5mM7FEO.png" alt="flag"></p>
<h2 id="cipher-text"><a href="#cipher-text" class="headerlink" title="cipher_text"></a>cipher_text</h2><p>we were given two files, a 64-bit elf binary and a text file containing some cipher. running strings on the binary give us a number of string references to “MEIPASS” which is a dead giveaway for PyInstaller </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/cipher_text ⌚ 15:20:41</span><br><span class="line">$ strings cipher2 | head</span><br><span class="line">/lib64/ld-linux-x86-64.so.2</span><br><span class="line">/wIP</span><br><span class="line">&quot;!!2</span><br><span class="line">libdl.so.2</span><br><span class="line">...</span><br><span class="line">Cannot open self %s or archive %s</span><br><span class="line">_MEIPASS2</span><br><span class="line">/proc/self/exe</span><br><span class="line">...</span><br><span class="line">pyi-</span><br><span class="line">out of memory</span><br><span class="line">_MEIPASS</span><br></pre></td></tr></table></figure>
<p>let’s try to recover pyc file from the binary using pyi-archive_viewer which came bundled with PyInstaller. read more about it <a href="https://pythonhosted.org/PyInstaller/advanced-topics.html#inspecting-archives" target="_blank" rel="noopener">HERE</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/cipher_text ⌚ 15:23:21</span><br><span class="line">$ pyi-archive_viewer cipher2 </span><br><span class="line"> pos, length, uncompressed, iscompressed, type, name</span><br><span class="line">[(0, 172, 237, 1, &apos;m&apos;, u&apos;struct&apos;),</span><br><span class="line"> (172, 1141, 2543, 1, &apos;m&apos;, u&apos;pyimod01_os_path&apos;),</span><br><span class="line"> (1313, 3918, 10567, 1, &apos;m&apos;, u&apos;pyimod02_archive&apos;),</span><br><span class="line"> (5231, 6008, 18151, 1, &apos;m&apos;, u&apos;pyimod03_importers&apos;),</span><br><span class="line"> (11239, 1543, 4347, 1, &apos;s&apos;, u&apos;pyiboot01_bootstrap&apos;),</span><br><span class="line"> (12782, 899, 2019, 1, &apos;s&apos;, u&apos;cipher2&apos;),</span><br><span class="line"> (13681, 642535, 642535, 0, &apos;z&apos;, u&apos;out00-PYZ.pyz&apos;)]</span><br><span class="line">? x cipher2</span><br><span class="line">to filename? cipher2.pyc</span><br><span class="line">? q</span><br><span class="line"> </span><br><span class="line">~/Desktop/cipher_text ⌚ 15:24:21</span><br><span class="line">$ ls -la</span><br><span class="line">total 688</span><br><span class="line">drwxrwxr-x 2 mkhdznfq mkhdznfq   4096 Nov 28 15:31 .</span><br><span class="line">drwxr-xr-x 6 mkhdznfq mkhdznfq   4096 Nov 28 15:16 ..</span><br><span class="line">-rwxr-xr-x 1 mkhdznfq mkhdznfq 687984 Nov 20 21:46 cipher2</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq   2019 Nov 28 15:31 cipher2.pyc</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq    145 Nov 20 21:46 cipher_text.txt</span><br></pre></td></tr></table></figure>
<p>now we can try to retrieve original python script from the pyc file using uncompyle6</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/cipher_text ⌚ 15:36:39</span><br><span class="line">$ uncompyle6 cipher2.pyc -o cipher2.py</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/usr/local/bin/uncompyle6&quot;, line 9, in &lt;module&gt;</span><br><span class="line">    load_entry_point(&apos;uncompyle6==2.9.6&apos;, &apos;console_scripts&apos;, &apos;uncompyle6&apos;)()</span><br><span class="line">  File &quot;build/bdist.linux-x86_64/egg/uncompyle6/bin/uncompile.py&quot;, line 164, in main_bin</span><br><span class="line">  File &quot;build/bdist.linux-x86_64/egg/uncompyle6/main.py&quot;, line 146, in main</span><br><span class="line">  File &quot;build/bdist.linux-x86_64/egg/uncompyle6/main.py&quot;, line 62, in uncompyle_file</span><br><span class="line">  File &quot;/usr/local/lib/python2.7/dist-packages/xdis/load.py&quot;, line 103, in load_module</span><br><span class="line">    (ord(magic[0])+256*ord(magic[1]), filename))</span><br><span class="line">ImportError: Unknown magic number 99 in cipher2.pyc</span><br></pre></td></tr></table></figure>
<p>uh-oh, looks like it cannot find the magic number in the header. this can be fixed by compiling our own pyc file and append the missing bytes to cipher2.pyc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/cipher_text ⌚ 15:40:30</span><br><span class="line">$ touch dummy.py </span><br><span class="line"> </span><br><span class="line">~/Desktop/cipher_text ⌚ 15:40:37</span><br><span class="line">$ python</span><br><span class="line">Python 2.7.12 (default, Nov 19 2016, 06:48:10) </span><br><span class="line">[GCC 5.4.0 20160609] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; import py_compile</span><br><span class="line">&gt;&gt;&gt; py_compile.compile(&quot;dummy.py&quot;)</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line"> </span><br><span class="line">~/Desktop/cipher_text ⌚ 15:41:07</span><br><span class="line">$ (head -c 8 dummy.pyc &amp;&amp; cat cipher2.pyc) &gt; cipher2_fix.pyc</span><br><span class="line"> </span><br><span class="line">~/Desktop/cipher_text ⌚ 15:41:38</span><br><span class="line">$ uncompyle6 -o ./ cipher2_fix.pyc</span><br><span class="line">Successfully decompiled file</span><br><span class="line"> </span><br><span class="line">~/Desktop/cipher_text ⌚ 15:43:18</span><br><span class="line">$ ls -la</span><br><span class="line">total 700</span><br><span class="line">drwxrwxr-x 2 mkhdznfq mkhdznfq   4096 Nov 28 15:46 .</span><br><span class="line">drwxr-xr-x 6 mkhdznfq mkhdznfq   4096 Nov 28 15:16 ..</span><br><span class="line">-rwxr-xr-x 1 mkhdznfq mkhdznfq 687984 Nov 20 21:46 cipher2</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq   2034 Nov 28 15:46 cipher2_fix.py</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq   2027 Nov 28 15:41 cipher2_fix.pyc</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq   2019 Nov 28 15:31 cipher2.pyc</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq    145 Nov 20 21:46 cipher_text.txt</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq      0 Nov 28 15:40 dummy.py</span><br><span class="line">-rw-rw-r-- 1 mkhdznfq mkhdznfq     95 Nov 28 15:41 dummy.pyc</span><br></pre></td></tr></table></figure>
<p>let’s open cipher2_fix.py in a text editor and analyze the source code:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 2.9.6</span></span><br><span class="line"><span class="comment"># Python bytecode 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.12 (default, Nov 19 2016, 06:48:10) </span></span><br><span class="line"><span class="comment"># [GCC 5.4.0 20160609]</span></span><br><span class="line"><span class="comment"># Embedded file name: cipher2.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2016-11-28 15:40:37</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">cipher_dict = &#123;&#125;</span><br><span class="line">cipher_dict[<span class="string">'1'</span>] = <span class="string">'`4rM'</span></span><br><span class="line">cipher_dict[<span class="string">'0'</span>] = <span class="string">'[0iR'</span></span><br><span class="line">cipher_dict[<span class="string">'3'</span>] = <span class="string">'=8lK'</span></span><br><span class="line">cipher_dict[<span class="string">'2'</span>] = <span class="string">'&#123;0bE'</span></span><br><span class="line">cipher_dict[<span class="string">'5'</span>] = <span class="string">'&#123;4dW'</span></span><br><span class="line">cipher_dict[<span class="string">'4'</span>] = <span class="string">'/7xK'</span></span><br><span class="line">cipher_dict[<span class="string">'7'</span>] = <span class="string">'&lt;3qU'</span></span><br><span class="line">cipher_dict[<span class="string">'6'</span>] = <span class="string">'?9pB'</span></span><br><span class="line">cipher_dict[<span class="string">'9'</span>] = <span class="string">'\x06vR'</span></span><br><span class="line">cipher_dict[<span class="string">'8'</span>] = <span class="string">'$5wD'</span></span><br><span class="line">cipher_dict[<span class="string">'A'</span>] = <span class="string">'q[c3'</span></span><br><span class="line">cipher_dict[<span class="string">'C'</span>] = <span class="string">'a*v0'</span></span><br><span class="line">cipher_dict[<span class="string">'B'</span>] = <span class="string">'q&lt;u1'</span></span><br><span class="line">cipher_dict[<span class="string">'E'</span>] = <span class="string">'m?n3'</span></span><br><span class="line">cipher_dict[<span class="string">'D'</span>] = <span class="string">'w%r0'</span></span><br><span class="line">cipher_dict[<span class="string">'G'</span>] = <span class="string">'o&amp;h1'</span></span><br><span class="line">cipher_dict[<span class="string">'F'</span>] = <span class="string">'o!s8'</span></span><br><span class="line">cipher_dict[<span class="string">'I'</span>] = <span class="string">'i`d1'</span></span><br><span class="line">cipher_dict[<span class="string">'H'</span>] = <span class="string">'m,b9'</span></span><br><span class="line">cipher_dict[<span class="string">'K'</span>] = <span class="string">'w_f0'</span></span><br><span class="line">cipher_dict[<span class="string">'J'</span>] = <span class="string">'u^g1'</span></span><br><span class="line">cipher_dict[<span class="string">'M'</span>] = <span class="string">"z'y6"</span></span><br><span class="line">cipher_dict[<span class="string">'L'</span>] = <span class="string">'i_g3'</span></span><br><span class="line">cipher_dict[<span class="string">'O'</span>] = <span class="string">'f(v9'</span></span><br><span class="line">cipher_dict[<span class="string">'N'</span>] = <span class="string">'l,o8'</span></span><br><span class="line">cipher_dict[<span class="string">'Q'</span>] = <span class="string">'b]w4'</span></span><br><span class="line">cipher_dict[<span class="string">'P'</span>] = <span class="string">'n@e4'</span></span><br><span class="line">cipher_dict[<span class="string">'S'</span>] = <span class="string">'b@i3'</span></span><br><span class="line">cipher_dict[<span class="string">'R'</span>] = <span class="string">'e~q7'</span></span><br><span class="line">cipher_dict[<span class="string">'U'</span>] = <span class="string">"w'l2"</span></span><br><span class="line">cipher_dict[<span class="string">'T'</span>] = <span class="string">'r&gt;j6'</span></span><br><span class="line">cipher_dict[<span class="string">'W'</span>] = <span class="string">'t/k7'</span></span><br><span class="line">cipher_dict[<span class="string">'V'</span>] = <span class="string">'t~b5'</span></span><br><span class="line">cipher_dict[<span class="string">'Y'</span>] = <span class="string">'r,b3'</span></span><br><span class="line">cipher_dict[<span class="string">'X'</span>] = <span class="string">'v/v9'</span></span><br><span class="line">cipher_dict[<span class="string">'Z'</span>] = <span class="string">'a#s7'</span></span><br><span class="line">cipher_dict[<span class="string">'_'</span>] = <span class="string">'8$dY'</span></span><br><span class="line">cipher_dict[<span class="string">'a'</span>] = <span class="string">'B8g`'</span></span><br><span class="line">cipher_dict[<span class="string">'c'</span>] = <span class="string">'D1k~'</span></span><br><span class="line">cipher_dict[<span class="string">'b'</span>] = <span class="string">'L7o['</span></span><br><span class="line">cipher_dict[<span class="string">'e'</span>] = <span class="string">'J4d&#123;'</span></span><br><span class="line">cipher_dict[<span class="string">'d'</span>] = <span class="string">'M3r\\'</span></span><br><span class="line">cipher_dict[<span class="string">'g'</span>] = <span class="string">'E9o~'</span></span><br><span class="line">cipher_dict[<span class="string">'f'</span>] = <span class="string">'K9m_'</span></span><br><span class="line">cipher_dict[<span class="string">'i'</span>] = <span class="string">'I7a\\'</span></span><br><span class="line">cipher_dict[<span class="string">'h'</span>] = <span class="string">'S6m`'</span></span><br><span class="line">cipher_dict[<span class="string">'k'</span>] = <span class="string">'H4q&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'j'</span>] = <span class="string">'P6q&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'m'</span>] = <span class="string">'T3k@'</span></span><br><span class="line">cipher_dict[<span class="string">'l'</span>] = <span class="string">'T8r)'</span></span><br><span class="line">cipher_dict[<span class="string">'o'</span>] = <span class="string">'M2s&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'n'</span>] = <span class="string">'M5h&#123;'</span></span><br><span class="line">cipher_dict[<span class="string">'q'</span>] = <span class="string">'J8k/'</span></span><br><span class="line">cipher_dict[<span class="string">'p'</span>] = <span class="string">'K4j~'</span></span><br><span class="line">cipher_dict[<span class="string">'s'</span>] = <span class="string">'X8o&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'r'</span>] = <span class="string">'B7r&gt;'</span></span><br><span class="line">cipher_dict[<span class="string">'u'</span>] = <span class="string">'X9u^'</span></span><br><span class="line">cipher_dict[<span class="string">'t'</span>] = <span class="string">'Y5u|'</span></span><br><span class="line">cipher_dict[<span class="string">'w'</span>] = <span class="string">'B4b%'</span></span><br><span class="line">cipher_dict[<span class="string">'v'</span>] = <span class="string">'H2n,'</span></span><br><span class="line">cipher_dict[<span class="string">'y'</span>] = <span class="string">'U6p.'</span></span><br><span class="line">cipher_dict[<span class="string">'x'</span>] = <span class="string">'G6i|'</span></span><br><span class="line">cipher_dict[<span class="string">'&#123;'</span>] = <span class="string">'U-a9'</span></span><br><span class="line">cipher_dict[<span class="string">'z'</span>] = <span class="string">'D2e('</span></span><br><span class="line">cipher_dict[<span class="string">'&#125;'</span>] = <span class="string">'^Zr2'</span></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span>:</span><br><span class="line">    l = list(sys.argv[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">print</span> cipher_dict[l[<span class="number">0</span>]]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>the script just take the first character of the argument passed and return a string based on the dictionary. this looks simple to reverse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"> </span><br><span class="line">cipher_dict = &#123;&#125;</span><br><span class="line">cipher_dict[<span class="string">'1'</span>] = <span class="string">'`4rM'</span></span><br><span class="line">cipher_dict[<span class="string">'0'</span>] = <span class="string">'[0iR'</span></span><br><span class="line">cipher_dict[<span class="string">'3'</span>] = <span class="string">'=8lK'</span></span><br><span class="line">cipher_dict[<span class="string">'2'</span>] = <span class="string">'&#123;0bE'</span></span><br><span class="line">cipher_dict[<span class="string">'5'</span>] = <span class="string">'&#123;4dW'</span></span><br><span class="line">cipher_dict[<span class="string">'4'</span>] = <span class="string">'/7xK'</span></span><br><span class="line">cipher_dict[<span class="string">'7'</span>] = <span class="string">'&lt;3qU'</span></span><br><span class="line">cipher_dict[<span class="string">'6'</span>] = <span class="string">'?9pB'</span></span><br><span class="line">cipher_dict[<span class="string">'9'</span>] = <span class="string">'\x06vR'</span></span><br><span class="line">cipher_dict[<span class="string">'8'</span>] = <span class="string">'$5wD'</span></span><br><span class="line">cipher_dict[<span class="string">'A'</span>] = <span class="string">'q[c3'</span></span><br><span class="line">cipher_dict[<span class="string">'C'</span>] = <span class="string">'a*v0'</span></span><br><span class="line">cipher_dict[<span class="string">'B'</span>] = <span class="string">'q&lt;u1'</span></span><br><span class="line">cipher_dict[<span class="string">'E'</span>] = <span class="string">'m?n3'</span></span><br><span class="line">cipher_dict[<span class="string">'D'</span>] = <span class="string">'w%r0'</span></span><br><span class="line">cipher_dict[<span class="string">'G'</span>] = <span class="string">'o&amp;h1'</span></span><br><span class="line">cipher_dict[<span class="string">'F'</span>] = <span class="string">'o!s8'</span></span><br><span class="line">cipher_dict[<span class="string">'I'</span>] = <span class="string">'i`d1'</span></span><br><span class="line">cipher_dict[<span class="string">'H'</span>] = <span class="string">'m,b9'</span></span><br><span class="line">cipher_dict[<span class="string">'K'</span>] = <span class="string">'w_f0'</span></span><br><span class="line">cipher_dict[<span class="string">'J'</span>] = <span class="string">'u^g1'</span></span><br><span class="line">cipher_dict[<span class="string">'M'</span>] = <span class="string">"z'y6"</span></span><br><span class="line">cipher_dict[<span class="string">'L'</span>] = <span class="string">'i_g3'</span></span><br><span class="line">cipher_dict[<span class="string">'O'</span>] = <span class="string">'f(v9'</span></span><br><span class="line">cipher_dict[<span class="string">'N'</span>] = <span class="string">'l,o8'</span></span><br><span class="line">cipher_dict[<span class="string">'Q'</span>] = <span class="string">'b]w4'</span></span><br><span class="line">cipher_dict[<span class="string">'P'</span>] = <span class="string">'n@e4'</span></span><br><span class="line">cipher_dict[<span class="string">'S'</span>] = <span class="string">'b@i3'</span></span><br><span class="line">cipher_dict[<span class="string">'R'</span>] = <span class="string">'e~q7'</span></span><br><span class="line">cipher_dict[<span class="string">'U'</span>] = <span class="string">"w'l2"</span></span><br><span class="line">cipher_dict[<span class="string">'T'</span>] = <span class="string">'r&gt;j6'</span></span><br><span class="line">cipher_dict[<span class="string">'W'</span>] = <span class="string">'t/k7'</span></span><br><span class="line">cipher_dict[<span class="string">'V'</span>] = <span class="string">'t~b5'</span></span><br><span class="line">cipher_dict[<span class="string">'Y'</span>] = <span class="string">'r,b3'</span></span><br><span class="line">cipher_dict[<span class="string">'X'</span>] = <span class="string">'v/v9'</span></span><br><span class="line">cipher_dict[<span class="string">'Z'</span>] = <span class="string">'a#s7'</span></span><br><span class="line">cipher_dict[<span class="string">'_'</span>] = <span class="string">'8$dY'</span></span><br><span class="line">cipher_dict[<span class="string">'a'</span>] = <span class="string">'B8g`'</span></span><br><span class="line">cipher_dict[<span class="string">'c'</span>] = <span class="string">'D1k~'</span></span><br><span class="line">cipher_dict[<span class="string">'b'</span>] = <span class="string">'L7o['</span></span><br><span class="line">cipher_dict[<span class="string">'e'</span>] = <span class="string">'J4d&#123;'</span></span><br><span class="line">cipher_dict[<span class="string">'d'</span>] = <span class="string">'M3r\\'</span></span><br><span class="line">cipher_dict[<span class="string">'g'</span>] = <span class="string">'E9o~'</span></span><br><span class="line">cipher_dict[<span class="string">'f'</span>] = <span class="string">'K9m_'</span></span><br><span class="line">cipher_dict[<span class="string">'i'</span>] = <span class="string">'I7a\\'</span></span><br><span class="line">cipher_dict[<span class="string">'h'</span>] = <span class="string">'S6m`'</span></span><br><span class="line">cipher_dict[<span class="string">'k'</span>] = <span class="string">'H4q&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'j'</span>] = <span class="string">'P6q&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'m'</span>] = <span class="string">'T3k@'</span></span><br><span class="line">cipher_dict[<span class="string">'l'</span>] = <span class="string">'T8r)'</span></span><br><span class="line">cipher_dict[<span class="string">'o'</span>] = <span class="string">'M2s&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'n'</span>] = <span class="string">'M5h&#123;'</span></span><br><span class="line">cipher_dict[<span class="string">'q'</span>] = <span class="string">'J8k/'</span></span><br><span class="line">cipher_dict[<span class="string">'p'</span>] = <span class="string">'K4j~'</span></span><br><span class="line">cipher_dict[<span class="string">'s'</span>] = <span class="string">'X8o&#125;'</span></span><br><span class="line">cipher_dict[<span class="string">'r'</span>] = <span class="string">'B7r&gt;'</span></span><br><span class="line">cipher_dict[<span class="string">'u'</span>] = <span class="string">'X9u^'</span></span><br><span class="line">cipher_dict[<span class="string">'t'</span>] = <span class="string">'Y5u|'</span></span><br><span class="line">cipher_dict[<span class="string">'w'</span>] = <span class="string">'B4b%'</span></span><br><span class="line">cipher_dict[<span class="string">'v'</span>] = <span class="string">'H2n,'</span></span><br><span class="line">cipher_dict[<span class="string">'y'</span>] = <span class="string">'U6p.'</span></span><br><span class="line">cipher_dict[<span class="string">'x'</span>] = <span class="string">'G6i|'</span></span><br><span class="line">cipher_dict[<span class="string">'&#123;'</span>] = <span class="string">'U-a9'</span></span><br><span class="line">cipher_dict[<span class="string">'z'</span>] = <span class="string">'D2e('</span></span><br><span class="line">cipher_dict[<span class="string">'&#125;'</span>] = <span class="string">'^Zr2'</span></span><br><span class="line"> </span><br><span class="line">cipher_text = <span class="string">"w_f0n@e4z'y6o&amp;h1U-a9`4rMq[c3T3k@B8g`T8r)=8lK/7xKK9m_[0iRM5h&#123;&lt;3qUS6m`=8lKB4b%`4rMM5h&#123;M3r\B4b%/7xK&lt;3qUa*v0m,b9S6m`[0iRt/k7I7a\&#123;4dWM2s&#125;/7xKB7r&gt;^Zr2"</span></span><br><span class="line">cipher_array = [cipher_text[i:i + <span class="number">4</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(cipher_text), <span class="number">4</span>)] <span class="comment"># split cipher_text by 4</span></span><br><span class="line">cipher_dict_rev = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> cipher_dict.iteritems()&#125; <span class="comment"># reverse cipher_dict value and key</span></span><br><span class="line"> </span><br><span class="line">map(<span class="keyword">lambda</span> x: sys.stdout.write(cipher_dict_rev[x]), cipher_array)</span><br></pre></td></tr></table></figure>
<p>running the above script will generate us the flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/cipher_text2 ⌚ 15:54:43</span><br><span class="line">$ python flag.py</span><br><span class="line">KPMG&#123;1Amal34f0n7h3w1ndw47CHh0Wi5o4r&#125;</span><br></pre></td></tr></table></figure>
<h2 id="serious-traffic"><a href="#serious-traffic" class="headerlink" title="serious_traffic"></a>serious_traffic</h2><p>we were distributed a pcap file (again!) and upon inspecting the protocol statistics, we can see it’s populated mostly by http traffics</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/serious_traffic ⌚ 16:15:58</span><br><span class="line">$ tshark -r suspicious_traffic.pcap -z io,phs</span><br><span class="line">  1   0.000000 192.168.56.103 -&gt; 192.168.56.101 TCP 64 1090 → 8080 [SYN] Seq=0 Win=64240 Len=0 MSS=1460 SACK_PERM=1</span><br><span class="line">  2   0.000016 192.168.56.101 -&gt; 192.168.56.103 TCP 64 8080 → 1090 [SYN, ACK] Seq=0 Ack=1 Win=29200 Len=0 MSS=1460 SACK_PERM=1</span><br><span class="line">  3   0.000349 192.168.56.103 -&gt; 192.168.56.101 TCP 62 1090 → 8080 [ACK] Seq=1 Ack=1 Win=64240 Len=0</span><br><span class="line">...</span><br><span class="line">===================================================================</span><br><span class="line">Protocol Hierarchy Statistics</span><br><span class="line">Filter: </span><br><span class="line"> </span><br><span class="line">sll                                      frames:3964 bytes:3144264</span><br><span class="line">  ip                                     frames:3964 bytes:3144264</span><br><span class="line">    tcp                                  frames:3964 bytes:3144264</span><br><span class="line">      vssmonitoring                      frames:1447 bytes:89714</span><br><span class="line">      http                               frames:1856 bytes:510391</span><br><span class="line">        media                            frames:78 bytes:56538</span><br><span class="line">      tcp.segments                       frames:2 bytes:46832</span><br><span class="line">===================================================================</span><br></pre></td></tr></table></figure>
<p>going through the http traffics we can conclude that the packets are captured conversations of metasploit’s meterpreter. i decided to focus on the victim packets (192.168.56.103) and inspect the data passed to the attacker (192.168.56.101). i also filter out the broadcasting packet (contains RECV) which the victim send to the attacker</p>
<p><img src="https://i.imgur.com/6h1vINP.jpg" alt="wireshark"></p>
<p>if you look closely at each packet listed, you can see that in each post data is accompanied by the original command from the attacker after 16 bytes. therefore, we can just skim through the packets and only check for interesting commands. some of them are:</p>
<ul>
<li>stdapi_ui_get_keys (dump keylogged buffer)</li>
<li>mimikatz_custom_command (mimikatz!) </li>
</ul>
<p>to dump the keylogged buffer, i’ve tweak metasploit code in order to make it work with extracted hextream:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># extracted from metasploit source code</span></span><br><span class="line"><span class="comment"># need to get hex stream of the buffer</span></span><br><span class="line"> </span><br><span class="line">VirtualKeyCodes = &#123;</span><br><span class="line">  <span class="number">1</span> =&gt; <span class="string">%W&#123; LClick &#125;</span>,</span><br><span class="line">  <span class="number">2</span> =&gt; <span class="string">%W&#123; RClick &#125;</span>,</span><br><span class="line">  <span class="number">3</span> =&gt; <span class="string">%W&#123; Cancel &#125;</span>,</span><br><span class="line">  <span class="number">4</span> =&gt; <span class="string">%W&#123; MClick &#125;</span>,</span><br><span class="line">  <span class="number">8</span> =&gt; <span class="string">%W&#123; Back  &#125;</span>,</span><br><span class="line">  <span class="number">9</span> =&gt; <span class="string">%W&#123; Tab  &#125;</span>,</span><br><span class="line">  <span class="number">10</span> =&gt; <span class="string">%W&#123; Newline &#125;</span>,</span><br><span class="line">  <span class="number">12</span> =&gt; <span class="string">%W&#123; Clear &#125;</span>,</span><br><span class="line">  <span class="number">13</span> =&gt; <span class="string">%W&#123; Return &#125;</span>,</span><br><span class="line">  <span class="number">16</span> =&gt; <span class="string">%W&#123; Shift &#125;</span>,</span><br><span class="line">  <span class="number">17</span> =&gt; <span class="string">%W&#123; Ctrl &#125;</span>,</span><br><span class="line">  <span class="number">18</span> =&gt; <span class="string">%W&#123; Alt &#125;</span>,</span><br><span class="line">  <span class="number">19</span> =&gt; <span class="string">%W&#123; Pause &#125;</span>,</span><br><span class="line">  <span class="number">20</span> =&gt; <span class="string">%W&#123; CapsLock &#125;</span>,</span><br><span class="line">  <span class="number">27</span> =&gt; <span class="string">%W&#123; Esc &#125;</span>,</span><br><span class="line">  <span class="number">32</span> =&gt; <span class="string">%W&#123; Space &#125;</span>,</span><br><span class="line">  <span class="number">33</span> =&gt; <span class="string">%W&#123; Prior &#125;</span>,</span><br><span class="line">  <span class="number">34</span> =&gt; <span class="string">%W&#123; Next &#125;</span>,</span><br><span class="line">  <span class="number">35</span> =&gt; <span class="string">%W&#123; End &#125;</span>,</span><br><span class="line">  <span class="number">36</span> =&gt; <span class="string">%W&#123; Home &#125;</span>,</span><br><span class="line">  <span class="number">37</span> =&gt; <span class="string">%W&#123; Left &#125;</span>,</span><br><span class="line">  <span class="number">38</span> =&gt; <span class="string">%W&#123; Up &#125;</span>,</span><br><span class="line">  <span class="number">39</span> =&gt; <span class="string">%W&#123; Right &#125;</span>,</span><br><span class="line">  <span class="number">40</span> =&gt; <span class="string">%W&#123; Down  &#125;</span>,</span><br><span class="line">  <span class="number">41</span> =&gt; <span class="string">%W&#123; Select &#125;</span>,</span><br><span class="line">  <span class="number">42</span> =&gt; <span class="string">%W&#123; Print &#125;</span>,</span><br><span class="line">  <span class="number">43</span> =&gt; <span class="string">%W&#123; Execute &#125;</span>,</span><br><span class="line">  <span class="number">44</span> =&gt; <span class="string">%W&#123; Snapshot &#125;</span>,</span><br><span class="line">  <span class="number">45</span> =&gt; <span class="string">%W&#123; Insert &#125;</span>,</span><br><span class="line">  <span class="number">46</span> =&gt; <span class="string">%W&#123; Delete &#125;</span>,</span><br><span class="line">  <span class="number">47</span> =&gt; <span class="string">%W&#123; Help &#125;</span>,</span><br><span class="line">  <span class="number">48</span> =&gt; <span class="string">%W&#123; 0  )&#125;</span>,</span><br><span class="line">  <span class="number">49</span> =&gt; <span class="string">%W&#123; 1  !&#125;</span>,</span><br><span class="line">  <span class="number">50</span> =&gt; <span class="string">%W&#123; 2  @&#125;</span>,</span><br><span class="line">  <span class="number">51</span> =&gt; <span class="string">%W&#123; 3  #&#125;</span>,</span><br><span class="line">  <span class="number">52</span> =&gt; <span class="string">%W&#123; 4  $&#125;</span>,</span><br><span class="line">  <span class="number">53</span> =&gt; <span class="string">%W&#123; 5  %&#125;</span>,</span><br><span class="line">  <span class="number">54</span> =&gt; <span class="string">%W&#123; 6  ^&#125;</span>,</span><br><span class="line">  <span class="number">55</span> =&gt; <span class="string">%W&#123; 7  &amp;&#125;</span>,</span><br><span class="line">  <span class="number">56</span> =&gt; <span class="string">%W&#123; 8  *&#125;</span>,</span><br><span class="line">  <span class="number">57</span> =&gt; <span class="string">%W&#123; 9  (&#125;</span>,</span><br><span class="line">  <span class="number">65</span> =&gt; <span class="string">%W&#123; a  A&#125;</span>,</span><br><span class="line">  <span class="number">66</span> =&gt; <span class="string">%W&#123; b  B&#125;</span>,</span><br><span class="line">  <span class="number">67</span> =&gt; <span class="string">%W&#123; c  C&#125;</span>,</span><br><span class="line">  <span class="number">68</span> =&gt; <span class="string">%W&#123; d  D&#125;</span>,</span><br><span class="line">  <span class="number">69</span> =&gt; <span class="string">%W&#123; e  E&#125;</span>,</span><br><span class="line">  <span class="number">70</span> =&gt; <span class="string">%W&#123; f  F&#125;</span>,</span><br><span class="line">  <span class="number">71</span> =&gt; <span class="string">%W&#123; g  G&#125;</span>,</span><br><span class="line">  <span class="number">72</span> =&gt; <span class="string">%W&#123; h  H&#125;</span>,</span><br><span class="line">  <span class="number">73</span> =&gt; <span class="string">%W&#123; i  I&#125;</span>,</span><br><span class="line">  <span class="number">74</span> =&gt; <span class="string">%W&#123; j  J&#125;</span>,</span><br><span class="line">  <span class="number">75</span> =&gt; <span class="string">%W&#123; k  K&#125;</span>,</span><br><span class="line">  <span class="number">76</span> =&gt; <span class="string">%W&#123; l  L&#125;</span>,</span><br><span class="line">  <span class="number">77</span> =&gt; <span class="string">%W&#123; m  M&#125;</span>,</span><br><span class="line">  <span class="number">78</span> =&gt; <span class="string">%W&#123; n  N&#125;</span>,</span><br><span class="line">  <span class="number">79</span> =&gt; <span class="string">%W&#123; o  O&#125;</span>,</span><br><span class="line">  <span class="number">80</span> =&gt; <span class="string">%W&#123; p  P&#125;</span>,</span><br><span class="line">  <span class="number">81</span> =&gt; <span class="string">%W&#123; q  Q&#125;</span>,</span><br><span class="line">  <span class="number">82</span> =&gt; <span class="string">%W&#123; r  R&#125;</span>,</span><br><span class="line">  <span class="number">83</span> =&gt; <span class="string">%W&#123; s  S&#125;</span>,</span><br><span class="line">  <span class="number">84</span> =&gt; <span class="string">%W&#123; t  T&#125;</span>,</span><br><span class="line">  <span class="number">85</span> =&gt; <span class="string">%W&#123; u  U&#125;</span>,</span><br><span class="line">  <span class="number">86</span> =&gt; <span class="string">%W&#123; v  V&#125;</span>,</span><br><span class="line">  <span class="number">87</span> =&gt; <span class="string">%W&#123; w  W&#125;</span>,</span><br><span class="line">  <span class="number">88</span> =&gt; <span class="string">%W&#123; x  X&#125;</span>,</span><br><span class="line">  <span class="number">89</span> =&gt; <span class="string">%W&#123; y  Y&#125;</span>,</span><br><span class="line">  <span class="number">90</span> =&gt; <span class="string">%W&#123; z  Z&#125;</span>,</span><br><span class="line">  <span class="number">91</span> =&gt; <span class="string">%W&#123; LWin &#125;</span>,</span><br><span class="line">  <span class="number">92</span> =&gt; <span class="string">%W&#123; RWin &#125;</span>,</span><br><span class="line">  <span class="number">93</span> =&gt; <span class="string">%W&#123; Apps &#125;</span>,</span><br><span class="line">  <span class="number">95</span> =&gt; <span class="string">%W&#123; Sleep &#125;</span>,</span><br><span class="line">  <span class="number">96</span> =&gt; <span class="string">%W&#123; N0 &#125;</span>,</span><br><span class="line">  <span class="number">97</span> =&gt; <span class="string">%W&#123; N1 &#125;</span>,</span><br><span class="line">  <span class="number">98</span> =&gt; <span class="string">%W&#123; N2 &#125;</span>,</span><br><span class="line">  <span class="number">99</span> =&gt; <span class="string">%W&#123; N3 &#125;</span>,</span><br><span class="line">  <span class="number">100</span> =&gt; <span class="string">%W&#123; N4 &#125;</span>,</span><br><span class="line">  <span class="number">101</span> =&gt; <span class="string">%W&#123; N5 &#125;</span>,</span><br><span class="line">  <span class="number">102</span> =&gt; <span class="string">%W&#123; N6 &#125;</span>,</span><br><span class="line">  <span class="number">103</span> =&gt; <span class="string">%W&#123; N7 &#125;</span>,</span><br><span class="line">  <span class="number">104</span> =&gt; <span class="string">%W&#123; N8 &#125;</span>,</span><br><span class="line">  <span class="number">105</span> =&gt; <span class="string">%W&#123; N9 &#125;</span>,</span><br><span class="line">  <span class="number">106</span> =&gt; <span class="string">%W&#123; Multiply &#125;</span>,</span><br><span class="line">  <span class="number">107</span> =&gt; <span class="string">%W&#123; Add &#125;</span>,</span><br><span class="line">  <span class="number">108</span> =&gt; <span class="string">%W&#123; Separator &#125;</span>,</span><br><span class="line">  <span class="number">109</span> =&gt; <span class="string">%W&#123; Subtract &#125;</span>,</span><br><span class="line">  <span class="number">110</span> =&gt; <span class="string">%W&#123; Decimal &#125;</span>,</span><br><span class="line">  <span class="number">111</span> =&gt; <span class="string">%W&#123; Divide &#125;</span>,</span><br><span class="line">  <span class="number">112</span> =&gt; <span class="string">%W&#123; F1 &#125;</span>,</span><br><span class="line">  <span class="number">113</span> =&gt; <span class="string">%W&#123; F2 &#125;</span>,</span><br><span class="line">  <span class="number">114</span> =&gt; <span class="string">%W&#123; F3 &#125;</span>,</span><br><span class="line">  <span class="number">115</span> =&gt; <span class="string">%W&#123; F4 &#125;</span>,</span><br><span class="line">  <span class="number">116</span> =&gt; <span class="string">%W&#123; F5 &#125;</span>,</span><br><span class="line">  <span class="number">117</span> =&gt; <span class="string">%W&#123; F6 &#125;</span>,</span><br><span class="line">  <span class="number">118</span> =&gt; <span class="string">%W&#123; F7 &#125;</span>,</span><br><span class="line">  <span class="number">119</span> =&gt; <span class="string">%W&#123; F8 &#125;</span>,</span><br><span class="line">  <span class="number">120</span> =&gt; <span class="string">%W&#123; F9 &#125;</span>,</span><br><span class="line">  <span class="number">121</span> =&gt; <span class="string">%W&#123; F10 &#125;</span>,</span><br><span class="line">  <span class="number">122</span> =&gt; <span class="string">%W&#123; F11 &#125;</span>,</span><br><span class="line">  <span class="number">123</span> =&gt; <span class="string">%W&#123; F12 &#125;</span>,</span><br><span class="line">  <span class="number">124</span> =&gt; <span class="string">%W&#123; F13 &#125;</span>,</span><br><span class="line">  <span class="number">125</span> =&gt; <span class="string">%W&#123; F14 &#125;</span>,</span><br><span class="line">  <span class="number">126</span> =&gt; <span class="string">%W&#123; F15 &#125;</span>,</span><br><span class="line">  <span class="number">127</span> =&gt; <span class="string">%W&#123; F16 &#125;</span>,</span><br><span class="line">  <span class="number">128</span> =&gt; <span class="string">%W&#123; F17 &#125;</span>,</span><br><span class="line">  <span class="number">129</span> =&gt; <span class="string">%W&#123; F18 &#125;</span>,</span><br><span class="line">  <span class="number">130</span> =&gt; <span class="string">%W&#123; F19 &#125;</span>,</span><br><span class="line">  <span class="number">131</span> =&gt; <span class="string">%W&#123; F20 &#125;</span>,</span><br><span class="line">  <span class="number">132</span> =&gt; <span class="string">%W&#123; F21 &#125;</span>,</span><br><span class="line">  <span class="number">133</span> =&gt; <span class="string">%W&#123; F22 &#125;</span>,</span><br><span class="line">  <span class="number">134</span> =&gt; <span class="string">%W&#123; F23 &#125;</span>,</span><br><span class="line">  <span class="number">135</span> =&gt; <span class="string">%W&#123; F24 &#125;</span>,</span><br><span class="line">  <span class="number">144</span> =&gt; <span class="string">%W&#123; NumLock &#125;</span>,</span><br><span class="line">  <span class="number">145</span> =&gt; <span class="string">%W&#123; Scroll &#125;</span>,</span><br><span class="line">  <span class="number">160</span> =&gt; <span class="string">%W&#123; LShift &#125;</span>,</span><br><span class="line">  <span class="number">161</span> =&gt; <span class="string">%W&#123; RShift &#125;</span>,</span><br><span class="line">  <span class="number">162</span> =&gt; <span class="string">%W&#123; LCtrl &#125;</span>,</span><br><span class="line">  <span class="number">163</span> =&gt; <span class="string">%W&#123; RCtrl &#125;</span>,</span><br><span class="line">  <span class="number">164</span> =&gt; <span class="string">%W&#123; LMenu &#125;</span>,</span><br><span class="line">  <span class="number">165</span> =&gt; <span class="string">%W&#123; RMenu &#125;</span>,</span><br><span class="line">  <span class="number">166</span> =&gt; <span class="string">%W&#123; Back &#125;</span>,</span><br><span class="line">  <span class="number">167</span> =&gt; <span class="string">%W&#123; Forward &#125;</span>,</span><br><span class="line">  <span class="number">168</span> =&gt; <span class="string">%W&#123; Refresh &#125;</span>,</span><br><span class="line">  <span class="number">169</span> =&gt; <span class="string">%W&#123; Stop &#125;</span>,</span><br><span class="line">  <span class="number">170</span> =&gt; <span class="string">%W&#123; Search &#125;</span>,</span><br><span class="line">  <span class="number">171</span> =&gt; <span class="string">%W&#123; Favorites &#125;</span>,</span><br><span class="line">  <span class="number">172</span> =&gt; <span class="string">%W&#123; Home &#125;</span>,</span><br><span class="line">  <span class="number">176</span> =&gt; <span class="string">%W&#123; Forward &#125;</span>,</span><br><span class="line">  <span class="number">177</span> =&gt; <span class="string">%W&#123; Reverse &#125;</span>,</span><br><span class="line">  <span class="number">178</span> =&gt; <span class="string">%W&#123; Stop &#125;</span>,</span><br><span class="line">  <span class="number">179</span> =&gt; <span class="string">%W&#123; Play &#125;</span>,</span><br><span class="line">  <span class="number">186</span> =&gt; <span class="string">%W&#123; ;  :&#125;</span>,</span><br><span class="line">  <span class="number">187</span> =&gt; <span class="string">%W&#123; =  +&#125;</span>,</span><br><span class="line">  <span class="number">188</span> =&gt; <span class="string">%W&#123; ,  &lt;&#125;</span>,</span><br><span class="line">  <span class="number">189</span> =&gt; <span class="string">%W&#123; -  _&#125;</span>,</span><br><span class="line">  <span class="number">190</span> =&gt; <span class="string">%W&#123; .  &gt;&#125;</span>,</span><br><span class="line">  <span class="number">191</span> =&gt; <span class="string">%W&#123; /  ?&#125;</span>,</span><br><span class="line">  <span class="number">192</span> =&gt; <span class="string">%W&#123; '  ~&#125;</span>,</span><br><span class="line">  <span class="number">219</span> =&gt; <span class="string">%W| [  &#123;|</span>,</span><br><span class="line">  <span class="number">220</span> =&gt; <span class="string">%W&#123; \  |&#125;</span>,</span><br><span class="line">  <span class="number">221</span> =&gt; <span class="string">%W| ]  &#125;|</span>,</span><br><span class="line">  <span class="number">222</span> =&gt; <span class="string">%W&#123; '  Quotes&#125;</span>,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keyscan_extract</span><span class="params">(buffer_data)</span></span></span><br><span class="line">  outp = <span class="string">""</span></span><br><span class="line">  buffer_data = [buffer_data].pack(<span class="string">"H*"</span>)</span><br><span class="line">  buffer_data.unpack(<span class="string">"n*"</span>).each <span class="keyword">do</span> <span class="params">|inp|</span></span><br><span class="line">    fl = (inp &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span></span><br><span class="line">    vk = (inp &amp; <span class="number">0xff</span>)</span><br><span class="line">    kc = VirtualKeyCodes[vk]</span><br><span class="line">    f_shift = fl &amp; (<span class="number">1</span>&lt;&lt;<span class="number">1</span>)</span><br><span class="line">    f_ctrl  = fl &amp; (<span class="number">1</span>&lt;&lt;<span class="number">2</span>)</span><br><span class="line">    f_alt   = fl &amp; (<span class="number">1</span>&lt;&lt;<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span>(kc)</span><br><span class="line">      name = ((f_shift != <span class="number">0</span> <span class="keyword">and</span> kc.length &gt; <span class="number">1</span>) ? kc[<span class="number">1</span>] : kc[<span class="number">0</span>])</span><br><span class="line">      <span class="keyword">case</span> name</span><br><span class="line">      <span class="keyword">when</span> /^.$/</span><br><span class="line">        outp &lt;&lt; name</span><br><span class="line">      <span class="keyword">when</span> /shift<span class="params">|click/i</span></span><br><span class="line"><span class="params">      <span class="keyword">when</span> 'Space'</span></span><br><span class="line"><span class="params">        outp &lt;&lt; " "</span></span><br><span class="line"><span class="params">      <span class="keyword">else</span></span></span><br><span class="line"><span class="params">        outp &lt;&lt; " &lt;#&#123;name&#125;&gt; "</span></span><br><span class="line"><span class="params">      <span class="keyword">end</span></span></span><br><span class="line"><span class="params">    <span class="keyword">else</span></span></span><br><span class="line"><span class="params">      outp &lt;&lt; " &lt;0x%.2x&gt; " % vk</span></span><br><span class="line"><span class="params">    <span class="keyword">end</span></span></span><br><span class="line"><span class="params">  <span class="keyword">end</span></span></span><br><span class="line"><span class="params">  <span class="keyword">return</span> outp</span></span><br><span class="line"><span class="params"><span class="keyword">end</span></span></span><br><span class="line"><span class="params"> </span></span><br><span class="line"><span class="params"># hex stream</span></span><br><span class="line"><span class="params">msg = "0000010b000000010000001b000100017374646170695f75695f6765745f6b657973000000002900010002313136393934363536363930363631313536343531313036333437353038313600000000b300010bb901010101014e014f015401450101014e014f0154014501db01500141010801080108015001410144010d010d010d010d010d010d0101031003a003530131031003a00342034e035201310139031003a003430144031003a00358035203550141031003a003470101014c015a0141031003a00358034e034f01420133031003a0035201300141031003a00347035603470142031003a003470346014e010d010d010d010d010d010d010d000000000c0002000400000000"</span></span><br><span class="line"><span class="params">puts keyscan_extract(msg)</span></span><br></pre></td></tr></table></figure>
<p>extracting the buffer reveals a base64 encoded string. but unfortunately it’s not our flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/serious_traffic ⌚ 17:52:03</span><br><span class="line">$ ruby keyscan_extract.rb</span><br><span class="line"> &lt;0x00&gt;  &lt;0x0b&gt;  &lt;0x00&gt;  &lt;0x00&gt;  &lt;Esc&gt;  &lt;F5&gt;  &lt;N1&gt;  &lt;N9&gt;  &lt;F6&gt;  &lt;Sleep&gt;  &lt;N5&gt;  &lt;Sleep&gt;  &lt;N5&gt;  &lt;F4&gt;  &lt;0x00&gt;  &lt;0x00&gt;  &lt;0x00&gt;  &lt;0x00&gt; !6966(6!5$10#701 &lt;0x00&gt;  &lt;0x00&gt;  &lt;Play&gt;  &lt;0xb9&gt; notenote[pa &lt;Back&gt;  &lt;Back&gt;  &lt;Back&gt; pad &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt; S1BNR19CdXRUaGlzaXNOb3R0aGVGbGFn &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;Return&gt;  &lt;0x00&gt;  &lt;0x00&gt;  &lt;0x00&gt;  &lt;0x00&gt;  &lt;0x00&gt;  &lt;0x00&gt; </span><br><span class="line"> </span><br><span class="line">~/Desktop/kpmg/serious_traffic ⌚ 17:52:28</span><br><span class="line">$ echo &quot;S1BNR19CdXRUaGlzaXNOb3R0aGVGbGFn&quot; | base64 -d</span><br><span class="line">KPMG_ButThisisNottheFlag</span><br></pre></td></tr></table></figure>
<p>now looking at the custom mimikatz command, we can see another base64 encoded string</p>
<p><img src="https://i.imgur.com/TfBe4TZ.png" alt="mimikatz"></p>
<p>cleaning and decoding it reveals our flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/serious_traffic ⌚ 17:56:04</span><br><span class="line">$ echo &quot;S1BNR3tNaW1pS0B0el8hNV9AdzM1MG5uZX0=&quot; | base64 -d</span><br><span class="line">KPMG&#123;MimiK@tz_!5_@w350nne&#125;</span><br></pre></td></tr></table></figure>
<h2 id="hard-crypto"><a href="#hard-crypto" class="headerlink" title="hard_crypto"></a>hard_crypto</h2><p>the challenge consist of two files - a text file containing description of the challenge and a password protected zip file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/hard_crypto ⌚ 8:54:16</span><br><span class="line">$ ls -la</span><br><span class="line">total 168</span><br><span class="line">drwxrwxr-x  2 mkhdznfq mkhdznfq   4096 Nov 28 20:35 .</span><br><span class="line">drwxrwxr-x 11 mkhdznfq mkhdznfq   4096 Nov 28 17:59 ..</span><br><span class="line">-rw-rw-r--  1 mkhdznfq mkhdznfq 156436 Nov 21 02:25 file</span><br><span class="line">-rw-rw-r--  1 mkhdznfq mkhdznfq    658 Nov 21 02:33 hard_crypto.txt</span><br><span class="line"></span><br><span class="line">~/Desktop/kpmg/hard_crypto ⌚ 8:54:19</span><br><span class="line">$ cat hard_crypto.txt </span><br><span class="line">The Umbrella corp decided to upgrade the secret information exchange and communication to something so-called more efficient and simple to be implemented...</span><br><span class="line"></span><br><span class="line">You are able to tap that piece of information and grabbed a file from the network...</span><br><span class="line">KBCVEQSWIVCSWTTKIEYU2VCRPJHEITJQJZ5FM3KOIRETCTSEIJUE2VCBPFHHUQTLJZLUK6CZNJATATKUNN4FUVCGNFHGUWL2JZCFE2COKRKXQWTKIU2U2V2JO5GVITTLJVKGOMKZPJATKTSHJUZU4VCZPBGVIWL2JVKEC6KONJATGT2UJUYE2R2FO5MWUQTIKBBTSRKRKZJEEUDKPBGFEVTLFNGXUQL2JVCE252NPJAXUTKEJV3U26SBPJGUITLXJV5ECM2NIRKXSTT2NMYU4VCWNBHGUZZRJZVFS6KNNJKTGTTKJZWU22SRGJMVISLYJZWVCMCZNJMTCTL2NMZU6RCWNBHHU2ZRJZCEU22OKRMTEWSUMMZU4R2RPFNEIWTIJZDVKM2PIRITAUCDHFGFEVTLFM</span><br></pre></td></tr></table></figure>
<p>the last line of the text file was encoded with base32. decoding it will expose a base64 encoded string</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/hard_crypto ⌚ 9:15:32</span><br><span class="line">$ echo -n &quot;KBCVEQSWIVCSWTTKIEYU2VCRPJHEITJQJZ5FM3KOIRETCTSEIJUE2VCBPFHHUQTLJZLUK6CZNJATATKUNN4FUVCGNFHGUWL2JZCFE2COKRKXQWTKIU2U2V2JO5GVITTLJVKGOMKZPJATKTSHJUZU4VCZPBGVIWL2JVKEC6KONJATGT2UJUYE2R2FO5MWUQTIKBBTSRKRKZJEEUDKPBGFEVTLFNGXUQL2JVCE252NPJAXUTKEJV3U26SBPJGUITLXJV5ECM2NIRKXSTT2NMYU4VCWNBHGUZZRJZVFS6KNNJKTGTTKJZWU22SRGJMVISLYJZWVCMCZNJMTCTL2NMZU6RCWNBHHU2ZRJZCEU22OKRMTEWSUMMZU4R2RPFNEIWTIJZDVKM2PIRITAUCDHFGFEVTLFM&quot; | base32 -d | base64 -d</span><br><span class="line">base32: invalid input</span><br><span class="line">&lt;DATA&gt;60514343475f42540a10270d5a1b04191e1b66344a551f191b013d185c094c75611631026079340a0b0a&lt;/DATA&gt;&lt;KEY&gt;30303030303030303030705279555a68566225763f246a216d4b6539785a79542d566e774d2d6a4e7844&lt;/KEYbase64: invalid input</span><br></pre></td></tr></table></figure>
<p>the encoded text was actually not padded correctly but alas, we still get what we wanted</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;DATA&gt;60514343475f42540a10270d5a1b04191e1b66344a551f191b013d185c094c75611631026079340a0b0a&lt;/DATA&gt;</span><br><span class="line">&lt;KEY&gt;30303030303030303030705279555a68566225763f246a216d4b6539785a79542d566e774d2d6a4e7844&lt;/KEY&gt;</span><br></pre></td></tr></table></figure>
<p>the values of data and key looks like it was hex encoded, but decoding it will only spit out gibberish value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/hard_crypto ⌚ 9:16:10</span><br><span class="line">$ python</span><br><span class="line">Python 2.7.12 (default, Nov 19 2016, 06:48:10) </span><br><span class="line">[GCC 5.4.0 20160609] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; &quot;60514343475f42540a10270d5a1b04191e1b66344a551f191b013d185c094c75611631026079340a0b0a&quot;.decode(&quot;hex&quot;)</span><br><span class="line">&quot;`QCCG_BT\n\x10&apos;\rZ\x1b\x04\x19\x1e\x1bf4JU\x1f\x19\x1b\x01=\x18\\\tLua\x161\x02`y4\n\x0b\n&quot;</span><br><span class="line">&gt;&gt;&gt; &quot;30303030303030303030705279555a68566225763f246a216d4b6539785a79542d566e774d2d6a4e7844&quot;.decode(&quot;hex&quot;)</span><br><span class="line">&apos;0000000000pRyUZhVb%v?$j!mKe9xZyT-VnwM-jNxD&apos;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>looking closely, the values was at the same length. maybe they are xored together</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/hard_crypto ⌚ 9:27:28</span><br><span class="line">$ python</span><br><span class="line">Python 2.7.12 (default, Nov 19 2016, 06:48:10) </span><br><span class="line">[GCC 5.4.0 20160609] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; data = &quot;60514343475f42540a10270d5a1b04191e1b66344a551f191b013d185c094c75611631026079340a0b0a&quot;.decode(&quot;hex&quot;)</span><br><span class="line">&gt;&gt;&gt; key = &quot;30303030303030303030705279555a68566225763f246a216d4b6539785a79542d566e774d2d6a4e7844&quot;.decode(&quot;hex&quot;)</span><br><span class="line">&gt;&gt;&gt; &apos;&apos;.join( chr( ord(a) ^ ord(b) ) for a,b in zip(data, key) )</span><br><span class="line">&apos;Password: W_#N^qHyCBuqu8vJX!$S5!L@_u-T^DsN&apos;</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>JACKPOT! now we can use the password to extract the zip file</p>
<p><img src="https://i.imgur.com/7soYw2q.png" alt="archive"></p>
<p>the extracted file was not recognized when it was run though file command. looking at its hexdump, I was able to recognize it as a jpeg file from the 0xffdb marker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/hard_crypto (copy) ⌚ 9:43:57</span><br><span class="line">$ file 5892347529374598234         </span><br><span class="line">5892347529374598234: data</span><br><span class="line"> </span><br><span class="line">~/Desktop/kpmg/hard_crypto (copy) ⌚ 9:44:41</span><br><span class="line">$ xxd 5892347529374598234| head</span><br><span class="line">00000000: 0048 0000 ffdb 0043 0001 0101 0101 0101  .H.....C........</span><br><span class="line">00000010: 0101 0101 0101 0101 0101 0101 0101 0101  ................</span><br><span class="line">00000020: 0101 0101 0101 0101 0101 0101 0101 0101  ................</span><br><span class="line">00000030: 0101 0101 0101 0101 0101 0101 0101 0101  ................</span><br><span class="line">00000040: 0101 0101 0101 0101 01ff db00 4301 0101  ............C...</span><br><span class="line">00000050: 0101 0101 0101 0101 0101 0101 0101 0101  ................</span><br><span class="line">00000060: 0101 0101 0101 0101 0101 0101 0101 0101  ................</span><br><span class="line">00000070: 0101 0101 0101 0101 0101 0101 0101 0101  ................</span><br><span class="line">00000080: 0101 0101 0101 0101 0101 0101 0101 ffc0  ................</span><br><span class="line">00000090: 0011 0804 1a06 9003 0111 0002 1101 0311  ................</span><br></pre></td></tr></table></figure>
<p>now let’s create a dummy jpg file with <a href="https://www.imagemagick.org/script/index.php" target="_blank" rel="noopener">imagemagick</a> and use that to append the missing header</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/hard_crypto (copy) ⌚ 9:44:44</span><br><span class="line">$ convert xc:white blank.jpg</span><br><span class="line"> </span><br><span class="line">~/Desktop/kpmg/hard_crypto (copy) ⌚ 9:50:08</span><br><span class="line">$ (head -c 16 blank.jpg &amp;&amp; cat 5892347529374598234) &gt; fixed.jpg</span><br><span class="line"> </span><br><span class="line">~/Desktop/kpmg/hard_crypto (copy) ⌚ 9:51:21</span><br><span class="line">$ file fixed.jpg</span><br><span class="line">fixed.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x72, segment length 16, baseline, precision 8, 1680x1050, frames 3</span><br></pre></td></tr></table></figure>
<p>viewing the image, we could see a qr code was embedded in the top right corner</p>
<p><img src="https://i.imgur.com/OmJe8ik.jpg" alt="fixed image"></p>
<p>after a little processing in gimp(crop, invert color and change input level) just upload it to an <a href="https://zxing.org/w/decode.jspx" target="_blank" rel="noopener">online qr decoder</a> to get “STEGHIDE_PASS:5aZ=zrd+AQ!hf8qL”. looks like it’s a password to an embedded data in the image. now extract the data using <a href="http://steghide.sourceforge.net" target="_blank" rel="noopener">steghide</a> to get a text file containing the flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~/Desktop/kpmg/hard_crypto ⌚ 13:05:28</span><br><span class="line">$ steghide extract -sf fixed.jpg -p &quot;5aZ=zrd+AQ\!hf8qL&quot;</span><br><span class="line">wrote extracted data to &quot;galF.txt&quot;.</span><br><span class="line"> </span><br><span class="line">~/Desktop/kpmg/hard_crypto ⌚ 13:05:48</span><br><span class="line">$ cat galF.txt</span><br><span class="line">KPMG&#123;Dv69u8@pwKGccGNBhM&amp;T32Bn$d4hX4Sm&#125;</span><br></pre></td></tr></table></figure>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#bounty-hunter"><span class="toc-number">1.</span> <span class="toc-text">bounty_hunter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#chal-mel"><span class="toc-number">2.</span> <span class="toc-text">chal_mel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cipher-text"><span class="toc-number">3.</span> <span class="toc-text">cipher_text</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#serious-traffic"><span class="toc-number">4.</span> <span class="toc-text">serious_traffic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hard-crypto"><span class="toc-number">5.</span> <span class="toc-text">hard_crypto</span></a></li></ol>
    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 mokhdzanifaeq
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="http://github.com/mokhdzanifaeq">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'mokhdzanifaeq';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


